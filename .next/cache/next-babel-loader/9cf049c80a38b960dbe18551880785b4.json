{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.call = exports.getChainId = exports.setChainIdOverride = exports.signData = exports.send = void 0;\n\nvar randomId = function randomId() {\n  return Math.floor(Math.random() * 10000000000);\n};\n\nexports.send = function (provider, method, params) {\n  return new Promise(function (resolve, reject) {\n    console.log(\"Send 1\");\n    var payload = {\n      id: randomId(),\n      method: method,\n      params: params,\n      from: \"0xd3Cbce59318B2E570883719c8165F9390A12BdD6\"\n    };\n    console.log(\"Send 2\", payload);\n\n    var callback = function callback(err, result) {\n      if (err) {\n        console.log(\"Send 3\", err);\n        reject(err);\n      } else if (result.error) {\n        console.log(\"Send 4\", result.error);\n        console.error(result.error);\n        reject(result.error);\n      } else {\n        console.log(\"Send 5\", result.result);\n        resolve(result.result);\n      }\n    }; // let _provider = provider.provider || provider;\n    // if (_rovider.sendAsync) {\n    //     console.log(\"privoder send async\")\n    //     _provider.sendAsync(payload, callback);\n    //   }\n    //   else {\n\n\n    console.log(\"privoder - normal send\", payload);\n    provider.send(payload, callback); // _provider.send(payload, callback);\n    // }\n  });\n};\n\nexports.signData = function (provider, fromAddress, typeData) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var _typeData, result;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            console.log(\"a-\");\n            _typeData = typeof typeData === 'string' ? typeData : JSON.stringify(typeData);\n            console.log(\"type data\", _typeData);\n            _context.next = 5;\n            return exports.send(provider, 'eth_signTypedData', [fromAddress, JSON.parse(_typeData)]);\n\n          case 5:\n            result = _context.sent;\n            console.log(\"b\");\n            return _context.abrupt(\"return\", {\n              r: result.slice(0, 66),\n              s: '0x' + result.slice(66, 130),\n              v: parseInt(result.slice(130, 132), 16)\n            });\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n};\n\nvar chainIdOverride = null;\n\nexports.setChainIdOverride = function (id) {\n  chainIdOverride = id;\n};\n\nexports.getChainId = function (provider) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            return _context2.abrupt(\"return\", chainIdOverride || exports.send(provider, 'eth_chainId'));\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n};\n\nexports.call = function (provider, to, data) {\n  return exports.send(provider, 'eth_call', [{\n    to: to,\n    data: data\n  }, 'latest']);\n};\n\nvar data = {\n  \"types\": {\n    \"EIP712Domain\": [{\n      \"name\": \"name\",\n      \"type\": \"string\"\n    }, {\n      \"name\": \"version\",\n      \"type\": \"string\"\n    }, {\n      \"name\": \"chainId\",\n      \"type\": \"uint256\"\n    }, {\n      \"name\": \"verifyingContract\",\n      \"type\": \"address\"\n    }],\n    \"Permit\": [{\n      \"name\": \"holder\",\n      \"type\": \"address\"\n    }, {\n      \"name\": \"spender\",\n      \"type\": \"address\"\n    }, {\n      \"name\": \"nonce\",\n      \"type\": \"uint256\"\n    }, {\n      \"name\": \"expiry\",\n      \"type\": \"uint256\"\n    }, {\n      \"name\": \"allowed\",\n      \"type\": \"bool\"\n    }]\n  },\n  \"primaryType\": \"Permit\",\n  \"domain\": {\n    \"name\": \"Dai Stablecoin\",\n    \"version\": \"1\",\n    \"chainId\": \"0x05\",\n    \"verifyingContract\": \"0x0099f841a6ab9a082828fac66134fd25c9d8a195\"\n  },\n  \"message\": {\n    \"holder\": \"0xd3Cbce59318B2E570883719c8165F9390A12BdD6\",\n    \"spender\": \"0x89e2d4628435368a7CD72611E769dDe27802b95e\",\n    \"nonce\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n    \"expiry\": \"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\",\n    \"allowed\": true\n  }\n};","map":{"version":3,"sources":["/home/jasoons/Documents/code/spikes/biconomy-tx-test/components/dist/rpc.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","call","getChainId","setChainIdOverride","signData","send","randomId","Math","floor","random","provider","method","params","console","log","payload","id","from","callback","err","error","fromAddress","typeData","_typeData","JSON","stringify","parse","r","slice","s","v","parseInt","chainIdOverride","to","data"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.call = exports.getChainId = exports.setChainIdOverride = exports.signData = exports.send = void 0;\nconst randomId = () => Math.floor(Math.random() * 10000000000);\nexports.send = (provider, method, params) => new Promise((resolve, reject) => {\n    console.log(\"Send 1\")\n    const payload = {\n      id: randomId(),\n      method,\n      params,\n      from: \"0xd3Cbce59318B2E570883719c8165F9390A12BdD6\"\n    };\n    console.log(\"Send 2\", payload);\n    const callback = (err, result) => {\n      if (err) {\n        console.log(\"Send 3\", err);\n        reject(err);\n      }\n      else if (result.error) {\n        console.log(\"Send 4\", result.error);\n        console.error(result.error);\n        reject(result.error);\n      }\n      else {\n        console.log(\"Send 5\", result.result);\n        resolve(result.result);\n        }\n    };\n    // let _provider = provider.provider || provider;\n    // if (_rovider.sendAsync) {\n    //     console.log(\"privoder send async\")\n    //     _provider.sendAsync(payload, callback);\n    //   }\n    //   else {\n\n        console.log(\"privoder - normal send\", payload)\n        provider.send(payload, callback);\n        // _provider.send(payload, callback);\n    // }\n});\nexports.signData = (provider, fromAddress, typeData) => __awaiter(void 0, void 0, void 0, function* () {\n    console.log(\"a-\")\n    const _typeData = typeof typeData === 'string' ? typeData : JSON.stringify(typeData);\n    console.log(\"type data\", _typeData);\n    const result = yield exports.send(provider, 'eth_signTypedData', [fromAddress, JSON.parse(_typeData)]);\n    console.log(\"b\")\n    return {\n        r: result.slice(0, 66),\n        s: '0x' + result.slice(66, 130),\n        v: parseInt(result.slice(130, 132), 16),\n    };\n});\nlet chainIdOverride = null;\nexports.setChainIdOverride = (id) => { chainIdOverride = id; };\nexports.getChainId = (provider) => __awaiter(void 0, void 0, void 0, function* () { return chainIdOverride || exports.send(provider, 'eth_chainId'); });\nexports.call = (provider, to, data) => exports.send(provider, 'eth_call', [{\n        to,\n        data,\n    }, 'latest']);\n\n\nlet data = {\"types\":{\"EIP712Domain\":[{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"version\",\"type\":\"string\"},{\"name\":\"chainId\",\"type\":\"uint256\"},{\"name\":\"verifyingContract\",\"type\":\"address\"}],\"Permit\":[{\"name\":\"holder\",\"type\":\"address\"},{\"name\":\"spender\",\"type\":\"address\"},{\"name\":\"nonce\",\"type\":\"uint256\"},{\"name\":\"expiry\",\"type\":\"uint256\"},{\"name\":\"allowed\",\"type\":\"bool\"}]},\"primaryType\":\"Permit\",\"domain\":{\"name\":\"Dai Stablecoin\",\"version\":\"1\",\"chainId\":\"0x05\",\"verifyingContract\":\"0x0099f841a6ab9a082828fac66134fd25c9d8a195\"},\"message\":{\"holder\":\"0xd3Cbce59318B2E570883719c8165F9390A12BdD6\",\"spender\":\"0x89e2d4628435368a7CD72611E769dDe27802b95e\",\"nonce\":\"0x0000000000000000000000000000000000000000000000000000000000000000\",\"expiry\":\"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\",\"allowed\":true}}\n\n"]},"metadata":{},"sourceType":"script"}